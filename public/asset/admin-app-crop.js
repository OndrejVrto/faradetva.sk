function watchImageUploader(t){var e=$(t.lastFileLabel).html();function n(){$(t.lastFileLabel).html(e)}function a(e){e.destroy(),$(t.modal).modal("hide"),$(t.cropButton).unbind(),$(t.cancelCropButton).unbind()}function i(n,a){$(t.output).val(n),$(t.fileName).val(a),$(t.preview).attr("src",n),$(t.input).val(""),e=a}function o(e){var o=new FileReader;o.onload=function(r){var c,l=document.createElement("img");l.onload=function(){!function(e){return!(e.width<t.minWidth||e.height<t.minHeight)||(alert("Obrázok má malé rozmery:\n\nŠírka najmenej "+t.minWidth+"px\nVýška najmenej "+t.minHeight+"px"),!1)}(l)?n():function(e){$(t.modal).modal("show");var n=!0;$(t.modal).on("shown.bs.modal",(function(){n&&(n=!1,e())}))}((function(){var r=$(t.cropperContainer)[0];r.src=o.result,cropper=new Cropper(r,{aspectRatio:t.ratio?t.minWidth/t.minHeight:null,viewMode:2,modal:!0,center:!0,zoomable:!1,movable:!1,rotatable:!1,scalable:!1,crop:function(e){var n=e.detail.width,a=e.detail.height;(n<t.minWidth||a<t.minHeight)&&cropper.setData({width:Math.max(t.minWidth,n),height:Math.max(t.minHeight,a)})}}),$(t.cancelCropButton).click((function(){a(cropper),n()})),$(t.cropButton).click((function(){cropper.crop();var o=cropper.getCroppedCanvas({fillColor:"#fff"}).toDataURL(e.type),r=document.createElement("img");r.onload=function(){var c=r.width*r.height;if(c>t.maxSize){var l=Math.sqrt(c/t.maxSize),m=r.width/l,d=r.height/l,h=document.createElement("canvas");h.width=m,h.height=d;var p=h.getContext("2d");p&&(p.drawImage(r,0,0,m,d),i(h.toDataURL(e.type),e.name))}else i(o,e.name);a(cropper),n()},r.src=o}))}))},l.src=null===(c=r.target)||void 0===c?void 0:c.result},o.readAsDataURL(e)}$(t.input).on("change",(function(e){o($(t.input)[0].files[0])}))}
